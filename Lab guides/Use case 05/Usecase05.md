**ユース ケース 05 - Azure RAG Accelerator を使用した会話型 AI
ソリューションのデプロイとテスト**

**紹介**

*Chat with your data* ソリューション アクセラレータは、Azure AI Search
と Large Language Models (LLM)
の機能を組み合わせて会話型検索エクスペリエンスを実現する強力なツールです。このソリューションアクセラレータは、Azure
OpenAI GPT モデルと、データから生成された Azure AI Search
インデックスを使用し、Web
アプリケーションに統合されて、検索クエリの音声テキスト変換機能を含む自然言語インターフェイスを提供します。ユーザーは、ファイルをドラッグアンドドロップしたり、ストレージを指したり、ドキュメントを変換するための技術的なセットアップを行ったりできます。ユーザーがセキュリティと認証を使用して自分のサブスクリプションで作成できるWebアプリがあります。

サンプル データは、このアクセラレーターを金融サービス業界 (FSI)
でどのように使用できるかを示しています。

このシナリオでは、ファイナンシャル アドバイザーが、Woodgrove Investments
の Emerging Markets Funds
に関心を示している潜在的なクライアントとの会議の準備をしています。アドバイザーは、新興市場ファンドの全体的な目標と関連するリスクについての理解を深めることにより、会議の準備をします。

ファイナンシャルアドバイザーがウッドグローブの新興市場ファンドについてより多くの情報を得たため、クライアントからのこのファンドに関する質問に回答する準備が整いました。

注: このアクセラレータに含まれるサンプル データの一部は AI
を使用して生成されたものであり、説明のみを目的としています。

このユース ケースでは、Azure RAG (Retrieval-Augmented Generation)
アクセラレータを使用して、会話型 AI
ソリューションをデプロイしてテストします。このソリューションは、Azure
OpenAI や Azure AI Search など、Azure の強力な AI
機能を活用して、高度な会話型検索エクスペリエンスを実現します。このラボを修了すると、自然言語処理を使用してデータを操作し、クエリを実行する、完全に機能する
Web
アプリケーションが完成します。実際の手順では、必要なインフラストラクチャのデプロイ、リソースの検証、ソリューションのテスト、および環境のクリーンアップをガイドします。![ダイアグラムのコンピューター
スクリーン ショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image1.png)

**目標**

- Azure portal のカスタム
  テンプレートから必要なインフラストラクチャをデプロイする。

- 必要なすべての Azure リソースが正常にデプロイされたことを確認します。

- デプロイされたソリューションの機能をテストするには、ドキュメントをアップロードして処理し、Web
  アプリケーションと対話します。

- デプロイされたリソースとモデルを削除します。

**タスク 1: テンプレートからインフラストラクチャをデプロイする**

1.  ブラウザを開き、アドレスバーに移動して、次のUR:+++
    :+++[www.portal.azure.com/+++then](http://www.portal.azure.com/+++then)を入力または貼り付けて**、Enter**ボタンを押します。

2.  **Microsoft
    Azure**ウィンドウで、**サインイン**資格情報を入力し、\[**Next** **\]**ボタンをクリックします。

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image2.png)

3.  次に、パスワードを入力し、\[**Sign
    in** **\]**ボタンをクリックします\*\*。

> ![ログインボックスのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image3.png)

4.  **Stay signed
    in?** ウィンドウで、\[**Yes** **\]**ボタンをクリックします。

> ![コンピュータ画面のスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image4.png)

5.  新しいブラウザーを開き、アドレス バーに
    +++<https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure-Samples%2Fchat-with-your-data-solution-accelerator%2Fmain%2Finfra%2Fmain.json+++>
    という URL を入力して Azure ポータルを開きます。

6.  \[**Custom deployment** \] ウィンドウの \[**Basics** \]
    タブで、次の詳細を入力してカスタム
    テンプレートを展開し、\[**Review + create\] をクリックします。**

[TABLE]

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image5.png)

7.  「**Review +
    create**」タブで、懸賞に合格したら「**Create」**ボタンをクリックします。

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image6.png)

8.  デプロイが完了するまで待ちます。デプロイには約 17 - 19
    分かかります。

9.  「**Go to Subscription** **」** ボタンをクリックします

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image7.png)

**タスク 2: Azure portal でデプロイされたリソースを確認する**

1.  ホームページで、「**Resource Groups」をクリックします**。

> ![コンピュータ画面のスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image8.png)

2.  リソースグループ名 **rg-RAGSolutionXX をクリックします。**

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image9.png)

3.  以下のリソースがEast
    USリージョンに正常にデプロイされたことを確認します

    - Azure App Service

    - Azure Application Insights

    - Azure Bot

    - Azure OpenAI

    - Azure Document Intelligence

    - Azure Function App

    - Azure Search Service

    - Azure Storage Account

    - Azure Speech Service

    - Azure Database for PostgreSQL - Flexible Server

    - Key vault

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image10.png)

![](./media/image11.png) ![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image12.png)

**タスク 3: デプロイのテスト**

1.  リソース グループで **\[Web-** {RESOURCE_TOKEN} **- admin-docker**
    resource name\] をクリックします。

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image13.png)

2.  管理サイト に移動します

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image14.png)
>
> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image15.png)

3.  **「Chat with your data Solution
    Accelerator**」ページで、左側のナビゲーション・メニューから「**Ingest
    Data」を選択します。**

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image16.png)

4.  \[ドキュメントの追加\]バッチペインで、\[**Browse
    file** **\]をクリックして**C:\\ Labfiles \\ data**の場所**
    に移動し**、all filesを選択して、\[Open** \]ボタンをクリックします。

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image17.png)

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image18.png)

5.  ファイルのアップロードには1〜2分かかります

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image19.png)

6.  **Reprocess all documents in the Azure Storage account
    をクリックします。**

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image20.png)

![チャットのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image21.png)

7.  \[**Chat with your data Solution Accelerator**\]
    ページで、左側のナビゲーション メニューから \[**Configuration** \]
    を選択し 、\[**check box- Enable post-answering prompt\]
    チェックボックスをオンにします。**

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image22.png)

8.  設定ペインで、\[**Save configuration\] をクリックします。**

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image23.png)

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image24.png)

9.  リソース グループ ページに戻り、**Storage
    account** 名をクリックします

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image25.png)

10. 左側のナビゲーション メニューから \[**Containers\]
    をクリックします。**

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image26.png)

11. \[コンテナ\] ページで、\[**documents**\] を選択します。

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image27.png)

12. すべてのファイルが正常にデプロイされることを確認します

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image28.png)

13. リソース グループ ページに戻ります

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image29.png)

14. リソース グループ ページで、 \[App Service\] を
    **\[web-{RESOURCE_TOKEN}-docker\] として選択します**

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image30.png)

15. \[Settings\]
    の下の折りたたみ可能な左側のメニューから、\[Authentication \]
    を選択します![コンピューターのスクリーンショット
    AIが生成したコンテンツが正しくない可能性があります。](./media/image31.png)

16. 「Add identify
    provider 」をクリックします。![コンピューターのスクリーンショット
    AIが生成したコンテンツが正しくない可能性があります。](./media/image32.png)

17. ID プロバイダーとして \[Microsoft\] を選択し、\[名前\] を
    web-XXXXX-docker-new に更新します。\[Client secret
    expirationの有効期限\] を 90 日間として選択し、Next:
    Permissionsをクリックします。![コンピューターのスクリーンショット
    AIが生成したコンテンツが正しくない可能性があります。](./media/image33.png)

18. 「Add permission」をクリックします。リストを下にスクロールして
    \[アプリケーション\] を展開し、 \[Application.ReadWrite.All\]
    を選択します。次に、\[Update permission\]をクリックします。

> ![コンピュータ画面のスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image34.png)

19. 「Add」をクリックします。

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image35.png)

20. アプリの\[Overview\]ページをクリックします。ページが読み込まれるのを待ってから、\[restart\]をクリックします。「yes」をクリックして再起動を確認します![コンピューターのスクリーンショット
    AIが生成したコンテンツが正しくない可能性があります。](./media/image36.png) ![コンピューターのスクリーンショット
    AIが生成したコンテンツが正しくない可能性があります。](./media/image37.png)

21. Web アプリ**のOverview** ページで、コマンド
    バーに移動し、\[**Browse**\] をクリックすると、Web
    アプリケーションに移動します。

> ![コンピューターのスクリーンショット
> AIが生成したコンテンツが正しくない可能性があります。](./media/image38.png)

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image39.png)

22. **Azure AI** Web アプリのページで、次のテキストを入力し、
    **次の図に示すように** \[**送信**\] アイコンをクリックします。

+++Describe in more detail the risks from market volatility+++ 

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image40.png) 

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image41.png)

17. \[チャット セッション**\]**
    セクションで、参照リンクを選択し、ページの右側にある検索ドキュメントの詳細を確認します。

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image42.png)

18. **Azure AI** Web アプリのページで、次のテキストを入力し、
    **次の図に示すように** \[送信\] アイコンをクリックします。

+++How does Woodgrove Financial handle payroll taxes for employees
outside the U.S.?+++ 

![チャットのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image43.png) ![チャットのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image44.png)

19. **Azure AI** Web アプリのページで、次のテキストを入力し、
    **次の図に示すように** \[送信\] アイコンをクリックします。

+++What is FORM 10-K and explain?+++ 

![チャットのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image45.png)

**タスク 4: Azure OpenAI リソースを削除する**

1.  Azure OpenAI リソースに移動し、 **Azure portal
    の検索バーに**「**Resource groups** 」と入力し、 **\[Services**\]
    の下の **\[Resource groups** \] に移動してクリックします。

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image46.png)

2.  リソースグループをクリックします。

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image9.png)

3.  リソース グループの概要ページで、 **\[Delete resource group\]
    を選択します**

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image47.png)

4.  右側に表示される \[**Delete Resources\] ペイン**で、**resource group
    name**を入力し、\[**Delete** \] ボタンをクリックします。

![コンピューターのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image48.png)

5.  **Delete
    confirmation** ダイアログボックスで、\[D**elete** \]ボタンをクリックします。

![コンピュータエラーのスクリーンショット
AIが生成したコンテンツが正しくない可能性があります。](./media/image49.png)

**概要**:

このラボでは、Azure RAG アクセラレータを使用して会話型 AI
ソリューションを展開する実践的な体験を提供します。ラボでは、カスタム
テンプレートを使用して必要なインフラストラクチャを展開しました。さまざまな
Azureリソースの展開が成功したことを確認した後、ドキュメントをアップロードし、Webアプリケーションを使用してクエリを実行して情報を取得することでソリューションをテストしました。最後に、リソースを効率的に管理するためにリソース
グループを削除しました。このラボでは、高度な
AIテクノロジを使用してデータの操作と取得を強化する方法を説明しました。
